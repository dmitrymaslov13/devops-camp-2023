user nginx nginx;

pid /run/nginx.pid;

events {}

http {
	log_format  						main        
													'$remote_addr - $remote_user [$time_local] "$request" '
													'$status $body_bytes_sent "$http_referer" '
													'"$http_user_agent" "$http_x_forwarded_for"';

	log_format  						json        
													'{"remote_addr": "$remote_addr",' 
													'"remote_user": "$remote_user",' 
													'"local_time": "$time_local",'
													'"request": "$request",'
													'"status": "$status",'
													'"body_bytes_sent": "$body_bytes_sent",'
													'"http_referer": "$http_referer",'
													'"http_user_agent": "$http_user_agent",'
													'"http_x_forwarded_for": "$http_x_forwarded_for"}';

	# Server for php camp with certification 
	server {
		listen                 443 ssl http2;
		listen                 [::]:443 ssl http2;
		server_name            camp-php.local;
		ssl_certificate        "./ssl/camp-php.local.pem";
		ssl_certificate_key    "./ssl/camp-php.local-key.pem";
		ssl_session_cache      shared:SSL:1m;
		ssl_session_timeout    10m;

		access_log             logs/camp-php-access.log json;
		error_log              logs/camp-php-error.log notice;
		error_log              logs/camp-php-error_debug.log debug;  

		include                shared/locations/hello.conf;
	}


	# Server for python camp with certification 
	server {
		listen                 443 ssl http2;
		listen                 [::]:443 ssl http2;
		server_name            camp-python.local;
		ssl_certificate        "./ssl/camp-python.local.pem";
		ssl_certificate_key    "./ssl/camp-python.local-key.pem";
		ssl_session_cache      shared:SSL:1m;
		ssl_session_timeout    10m;

		access_log             logs/camp-python-access.log main;
		error_log              logs/camp-python-error.log notice;
		error_log              logs/camp-python-error_debug.log debug;  
		
		include                shared/locations/hello.conf;
	}
}
